<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>Kakao 지도 시작하기</title>
    <style>
		#map {
			width: 100%;
			height: 800px;
		}
        .search-container {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 1;
            background: white;
            padding: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        #search-bar {
            width: 200px;
            padding: 5px;
        }
	</style>
</head>
<body>
	<div id="map"></div>
    <div class="search-container">
        <span class="search-icon" onclick="toggleSearch()">🔍</span>
        <input type="text" id="search-bar" placeholder="장소 검색..." onkeypress="handleSearch(event)">
    </div>
	<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=ebba33f14c992d835b3693d7ffe38005&libraries=services"></script>
	<script>
		var container = document.getElementById('map');
		var options = {
			center: new kakao.maps.LatLng(33.450701, 126.570667),
			level: 3
		};

		var map = new kakao.maps.Map(container, options);

        var ps = new kakao.maps.services.Places(); 

        function handleSearch(event) {
            if (event.key === 'Enter') {
                var keyword = document.getElementById('search-bar').value;
                ps.keywordSearch(keyword, placesSearchCB); 
            }
        }

        function placesSearchCB(data, status, pagination) {
            if (status === kakao.maps.services.Status.OK) {
                var bounds = new kakao.maps.LatLngBounds();
                
                for (var i = 0; i < data.length; i++) {
                    displayMarker(data[i]);    
                    bounds.extend(new kakao.maps.LatLng(data[i].y, data[i].x));
                }       
                
                map.setBounds(bounds);
            } 
        }

        function displayMarker(place) {
            var marker = new kakao.maps.Marker({
                map: map,
                position: new kakao.maps.LatLng(place.y, place.x) 
            });

            kakao.maps.event.addListener(marker, 'click', function() {
                var infowindow = new kakao.maps.InfoWindow({zIndex:1});
                infowindow.setContent('<div style="padding:5px;font-size:12px;">' + place.place_name + '</div>');
                infowindow.open(map, marker);
            });
        }
	</script>
</body>
</html>
